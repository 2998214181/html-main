# 组件设计

#### 一、设计组件原型

列子：

人的原型

1. name 名字
2. age 年龄

原型就是事物拥有哪些必须属性

组件属性(原型)：

1. name: 组件名称
2. el: 容器选择器
3. elDom: 容器dom元素
4. components： 组件集合
5. $refs: ref属性集合
6. data： 数据集合
7. $emit: 发送事件函数
8. $emits： 自定义事件集合
9. style: 样式属性
10. template： html模板
11. mounted： 事件加载完成运行函数
12. methods： 组件相关函数对象

#### 二、生成新组建

1. 通过配置合并组件原型生成新组件
2. 组件重置
3. 初始化组件
   1. 将组件里的子组件转换为组件原型
   2. 将组件样式和模板通过样式scoped值进行重构
   3. 解析生成dom元素
      1. 检测模板
      2. 检测是否存在el
      3. 解析组件dom
         1. 获取dom子元素
            1. 通过标签名获取组件
            2. 复制组件产生新组件
            3. 通过标签名引入样式
            4. 进行标签dom替换
4. 返回新组件



#### 五、组件传值

原因：组件需要用户设置变量值时，需要用到值传递





#### 六、组件解析

1. 生成新的组件elDom
2. 解析生成的组件
3. 添加组件父组件
4. 添加组件原始dom
5. 解析组件属性（m-attr、m-js、ref）

#### 七、组件标签的属性

1. ref: 存储组件dom
2. m-js:自定义事件
3. m-attr: 转换成组件dom的属性
4. 常规属性：转换成组件dom的属性
5. 组件拥有props,所以要先加m-attr和常规属性匹配props对象后，再将剩余的属性添加到dom属性上

#### 八、组件插槽

插槽的作用：需要用户自定义模板的时候，需要用到插槽

插槽值只做内容替换，不做其他事件



#### 九、复习

框架功能：

1. 解析ref
2. 解析属性
3. 解析事件
4. 自定义事件
5. 插槽

#### 十、m-text和{{}}

文本解析

#### 十一、m-if、m-elif、m-else

m-if:通过表达式返回值决定html元素是否展示

框架解析指令优先级最高



#### 十二、m-for

概念：循环



#### 十三、组件框架拥有功能

1. 解析组件
2. 注册组件局部组件或全局组件
3. 解析ref
4. 解析`{{}}`文本
5. 解析属性m-text
6. 解析m-attr  特殊解析m-attr:class、m-attr:style
7. 解析m-js
   1. 普通标签事件
   2. 自定义事件
8. 解析m-if m-elif m-else
9. 组件插槽
10. 解析m-for
11. 双向数据绑定

#### 十四、双向数据绑定

##### 1. 数据监听

```javascript

```



#### 运行js字符串

1. eval函数
2. 使用Function对象构造函数生成函数对象







